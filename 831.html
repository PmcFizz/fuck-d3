<!DOCTYPE html>
<html>
  <head>
    <title>先做一个柱状图</title>
  </head>

<body>
  <svg id="main" width="800" height="800"></svg>

  <script src="https://cdn.jsdelivr.net/npm/d3@7.0.1/dist/d3.min.js"></script>
  <script>
    const svg = d3.select("#main")
    const margin = { top: 30, right: 30, bottom: 30, left: 30 }
    const width = svg.attr('width')
    const height = svg.attr('height')

    const data = [
      { name: 'a', value: 1 },
      { name: 'b', value: 2 },
      { name: 'c', value: 3 },
      { name: 'd', value: 4 },
      { name: 'e', value: 5 },
    ]

    const innerHeight = height - margin.top - margin.bottom
    const innerWidth = width - margin.left - margin.right

    const xScale = d3.scaleBand()
                     .domain(data.map(x => x.name))
                     .range([0,innerWidth])
                     .padding(0.5)

    const yScale = d3.scaleLinear()
                     .domain([d3.max(data, x => x.value), 0])
                     .range([innerHeight, 0])


    const g =  svg.append('g')
                  .attr('id', 'maingroup')
                  .attr('transform', `translate(${margin.top}, ${margin.left})`)

    const yAxis = d3.axisLeft(yScale)
    g.append('g').call(yAxis)


    const xAxis = d3.axisBottom(xScale)
    g.append('g').call(xAxis).attr('transform',`translate(0, ${innerHeight})`)


    data.forEach(d => {
      g.append('rect')
       .attr('width', xScale.bandwidth())
       .attr('height',innerHeight - yScale(d.value))
       .attr('fill', 'green')
       .attr('x', xScale(d.name))
      //  .attr('transform',`translate(${innerHeight - yScale(d.value)}, 0)`)
    })




  </script>
</body>

</html>